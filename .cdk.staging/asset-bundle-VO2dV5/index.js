!function(e,n,o,i){var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t="function"==typeof r.parcelRequire&&r.parcelRequire,s="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function a(o,i){if(!n[o]){if(!e[o]){var r="function"==typeof parcelRequire&&parcelRequire;if(!i&&r)return r(o,!0);if(t)return t(o,!0);if(s&&"string"==typeof o)return s(o);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}f.resolve=function(n){return e[o][1][n]||n},f.cache={};var d=n[o]=new a.Module(o);e[o][0].call(d.exports,f,d,d.exports,this)}return n[o].exports;function f(e){return a(f.resolve(e))}}a.isParcelRequire=!0,a.Module=function(e){this.id=e,this.bundle=a,this.exports={}},a.modules=e,a.cache=n,a.parent=t,a.register=function(n,o){e[n]=[function(e,n){n.exports=o},{}]},r.parcelRequire=a;for(var c=0;c<o.length;c++)a(o[c]);if(o.length){var d=a(o[o.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=d:"function"==typeof define&&define.amd&&define((function(){return d}))}}({"95e4cec49bcc9d1b06a9031287085ca6":[function(e,n,o){const i=e("aws-sdk"),r=new i.ECR,t=new i.SES;o.handler=async e=>{console.log(JSON.stringify(e,void 0,2));const n=JSON.parse(e.Records[0].Sns.Message).detail["repository-name"],o={imageId:{imageTag:"latest"},repositoryName:n},i=await r.describeImageScanFindings(o).promise();if(i.$response.error||!i.imageScanFindings)throw new Error(JSON.stringify(i.$response.error));const s=i.imageScanFindings.findings;if(!s)return void console.log("No image scan findings for "+i.repositoryName);const a=s.length;if(a>0){const e=`Found ${a} security findings for ${n} at ${i.imageScanFindings.imageScanCompletedAt}`,o=s.reduce((e,n)=>`${n.name} (${n.severity}): ${n.uri}\n\n${e}`,"");console.log(e),console.log(o),await(async(e,n)=>{const o=process.env.FROM_ADDRESS;if(!o)throw new Error("Missing FROM_ADDRESS");const i=process.env.TO_ADDRESS;if(!i)throw new Error("Missing TO_ADDRESS");const r={Source:o,Destination:{ToAddresses:[i]},Message:{Subject:{Data:e},Body:{Text:{Data:n}}}},s=await t.sendEmail(r).promise();console.log(s)})(e,o)}}},{}]},{},["95e4cec49bcc9d1b06a9031287085ca6"]);
//# sourceMappingURL=index.js.map
